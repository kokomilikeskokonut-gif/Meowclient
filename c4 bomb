local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

-- // Configuration
local OrbitSettings = {
    Radius = 5,
    Speed = 15,
    Height = 2,
    Active = false
}

local TargetPlayer = nil
local PlayerList = {}
local CurrentIndex = 1

-- // UI (Basic Selector)
local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
local Main = Instance.new("Frame", ScreenGui)
Main.Size = UDim2.new(0, 200, 0, 140)
Main.Position = UDim2.new(0, 50, 0.5, -70)
Main.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
Main.Active = true
Main.Draggable = true
Instance.new("UICorner", Main)

local Title = Instance.new("TextLabel", Main)
Title.Size = UDim2.new(1, 0, 0, 30)
Title.Text = "ORBIT KILLER"
Title.BackgroundColor3 = Color3.fromRGB(80, 0, 200)
Title.TextColor3 = Color3.new(1,1,1)

local NameDisplay = Instance.new("TextLabel", Main)
NameDisplay.Size = UDim2.new(1, 0, 0, 40)
NameDisplay.Position = UDim2.new(0, 0, 0.25, 0)
NameDisplay.BackgroundTransparency = 1
NameDisplay.TextColor3 = Color3.new(1,1,1)
NameDisplay.Text = "Select Target"

local NextBtn = Instance.new("TextButton", Main)
NextBtn.Size = UDim2.new(0, 30, 0, 30)
NextBtn.Position = UDim2.new(0.8, 0, 0.3, 0)
NextBtn.Text = ">"

local PrevBtn = Instance.new("TextButton", Main)
PrevBtn.Size = UDim2.new(0, 30, 0, 30)
PrevBtn.Position = UDim2.new(0.05, 0, 0.3, 0)
PrevBtn.Text = "<"

local Status = Instance.new("TextLabel", Main)
Status.Size = UDim2.new(1, 0, 0, 30)
Status.Position = UDim2.new(0, 0, 0.7, 0)
Status.BackgroundTransparency = 1
Status.Text = "Orbit: OFF [K]"
Status.TextColor3 = Color3.fromRGB(255, 0, 0)

-- // Logic
local function UpdateUI()
    PlayerList = {}
    for _, v in pairs(Players:GetPlayers()) do
        if v ~= LocalPlayer then table.insert(PlayerList, v) end
    end
    if #PlayerList > 0 then
        if CurrentIndex > #PlayerList then CurrentIndex = 1 end
        if CurrentIndex < 1 then CurrentIndex = #PlayerList end
        TargetPlayer = PlayerList[CurrentIndex]
        NameDisplay.Text = TargetPlayer.Name
    end
end

NextBtn.MouseButton1Click:Connect(function() CurrentIndex += 1 UpdateUI() end)
PrevBtn.MouseButton1Click:Connect(function() CurrentIndex -= 1 UpdateUI() end)
UpdateUI()

-- // Orbit Engine
local Angle = 0
RunService.RenderStepped:Connect(function(dt)
    if OrbitSettings.Active and TargetPlayer and TargetPlayer.Character and TargetPlayer.Character:FindFirstChild("HumanoidRootPart") then
        local char = LocalPlayer.Character
        local hrp = char and char:FindFirstChild("HumanoidRootPart")
        local targetHrp = TargetPlayer.Character.HumanoidRootPart
        
        if hrp then
            -- Calculate Orbit Position
            Angle = Angle + (OrbitSettings.Speed * dt)
            local x = math.cos(Angle) * OrbitSettings.Radius
            local z = math.sin(Angle) * OrbitSettings.Radius
            
            hrp.CFrame = CFrame.new(targetHrp.Position + Vector3.new(x, OrbitSettings.Height, z), targetHrp.Position)
            
            -- Auto-Use Slot 1 Weapon
            local tool = LocalPlayer.Backpack:GetChildren()[1] or char:FindFirstChildOfClass("Tool")
            if tool then
                if tool.Parent ~= char then tool.Parent = char end -- Equip if not held
                tool:Activate() -- Fire/Plant/Explode
            end
        end
    end
end)

-- // Toggle
UIS.InputBegan:Connect(function(input, gpe)
    if gpe then return end
    if input.KeyCode == Enum.KeyCode.K then
        OrbitSettings.Active = not OrbitSettings.Active
        Status.Text = OrbitSettings.Active and "Orbit: ON [K]" or "Orbit: OFF [K]"
        Status.TextColor3 = OrbitSettings.Active and Color3.new(0,1,0) or Color3.new(1,0,0)
        
        -- Noclip toggle so you don't get stuck in walls while orbiting
        if LocalPlayer.Character then
            for _, v in pairs(LocalPlayer.Character:GetDescendants()) do
                if v:IsA("BasePart") then v.CanCollide = not OrbitSettings.Active end
            end
        end
    end
end)
